<html>

<head>
  <title>確率計算</title>
  <script language="JavaScript">
    function cal() {
      var aDeck = Number(document.numberForm.elements[0].value);
      var bKey = Number(document.numberForm.elements[1].value);
      var cDraw = Number(document.numberForm.elements[2].value);
      var dLeast = Number(document.numberForm.elements[4].value);
      var eMost = Number(document.numberForm.elements[3].value);
      var res = 0;
      for (i = eMost; i <= dLeast; i++) {
        res +=
          permutation(bKey, i) * permutation(aDeck - bKey, cDraw - i) /
          permutation(aDeck, cDraw) * combination(cDraw, i);
      }

      document.numberForm.elements[6].value = Math.round(res * 100 * 100) / 100;
      document.numberForm.elements[7].value = Math.floor(1 / res * 100) / 100;
    }

    function combination(n, m) {
      if (n < m) return 0;
      var res2 = 1;
      for (j = 0; j < m; j++)res2 *= n - j;
      for (k = 0; k < m; k++)res2 /= m - k;
      //alert(n + "C" + m + "=" + res2);
      return res2;
    }

    function permutation(n, m) {
      if (n < m) return 0;
      var res2 = 1;
      for (l = 0; l < m; l++)res2 *= n - l;
      //alert(n + "P" + m + "=" + res2);
      return res2;
    }

  </script>
</head>

<body>
  <form name="numberForm">
    <font size=6>カードゲーム確率計算</font>
    <br>
    <br> Deck
    <input type="number" size="4" value=60>
    <br> KeyCard
    <input type="number" size="4" value=10>
    <br> Draw
    <input type="number" size="4" value=7>
    <br> Least
    <input type="number" size="4" value=1>
    <br> Most
    <input type="number" size="4" value=7>
    <br>
    <input type=button value="計算" onclick="cal();">
    <br>
    <br>
    <div id="div1">計算結果</div>
    <input type=number size="24">％→約
    <input type=number size="15">回に１回の確率です
    <br>
  </form>
</body>

</html>